"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[9852],{80360:(p,l,t)=>{t.d(l,{$:()=>s});var a=t(60177),o=t(89417),_=t(24318),i=t(54438);let s=(()=>{class f{static#e=this.\u0275fac=function(h){return new(h||f)};static#t=this.\u0275mod=i.$C({type:f});static#r=this.\u0275inj=i.G2t({imports:[a.MD,o.X1,_.F]})}return f})();t(26320)},4255:(p,l,t)=>{t.d(l,{F:()=>h});var a=t(88141),o=t(96354),_=t(61594),i=t(84412),s=t(54438),S=t(40735),f=t(17691),d=t(21638);function O(c){return c.photos&&c.photos.length?c.photos[0].lg:null}let h=(()=>{class c{constructor(e,r,n){this._apiService=e,this._offersQuery=r,this._offersStore=n,this.offersSource=new i.t([]),this.savedOffersSource=new i.t([]),this.offersLength=new i.t(0),this.savedOffersLength=new i.t(0),this._endpoint="offers/"}get offers$(){return this.offersSource.asObservable()}get savedOffers$(){return this.savedOffersSource.asObservable()}get offersLength$(){return this.offersLength.asObservable()}get savedOffersLength$(){return this.savedOffersLength.asObservable()}removeAllOffers(){return this._apiService.delete("offers/delete")}getContainerLocation(e){return this._apiService.get(`container/location?${e}`)}getAllOffersCount(){return this._offersQuery.selectAllOffersCount$}getSeaLines(){const{seaLines:e}=this._offersQuery.getValue();return e.length||this._apiService.get("seaLines").subscribe(r=>{this._offersStore.update({seaLines:r})}),this._offersQuery.selectSeaLines$}markAsSold(e){this._apiService.post(`offer/${e}/status/update`,{status:"sold"}).pipe().subscribe()}hideOffer(e){return this._apiService.post(`offer/${e}/hide`,{})}unHideOffer(e){return this._apiService.post(`offer/${e}/unHide`,{})}adminHideOffer(e){return this._apiService.post(`offer/${e}/adminHide`,{})}adminUnHideOffer(e){return this._apiService.post(`offer/${e}/adminUnHide`,{})}deleteOfferSub(e){return this._apiService.delete(`offer/${e}/delete`)}deleteRfq(e){return this._apiService.delete("tradeBid/delete-rfq-admin",{body:{rfqId:e}})}deleteOfferById(e,r){return this._apiService.delete(`offer/${e}/delete`,r)}getOfferById(e){return this._apiService.get(`offer/${e}/`).pipe((0,a.M)(r=>{this._offersStore.update({offer:r})}))}getMyOffers(){return this._apiService.get("my/offers?limit=1").subscribe(e=>{this._offersStore.update({myOffers:e.map(r=>({...r,previewPhoto:O(r)}))})}),this._offersQuery.selectMyOffers$}getOffers(e=""){return this._apiService.get("offers/"+e).pipe((0,o.T)(r=>{const{offers:n,totalCount:u}=r,v=n.map(m=>({...m,previewPhoto:O(m)}));return this._offersStore.update({allOffers:v,allOffersCount:u}),[...v]}))}getActiveOffers(){return this._apiService.get("offers?hideSold=true").pipe((0,o.T)(e=>{const{offers:r,totalCount:n}=e,u=r.map(v=>({...v,previewPhoto:O(v)}));return this._offersStore.update({allOffers:u,allOffersCount:n}),[...u]}))}getSavedOffers(){return this._apiService.get("my/offers/favourites").subscribe(r=>{this._offersStore.update({savedOffers:r.map(n=>({...n,previewPhoto:O(n)}))})}),this._offersQuery.selectSavedOffers$}createOffer(e){return this._apiService.post("offer/create",e)}updateOffer(e,r){return this._apiService.put(`offer/${r}/update`,e)}addFavoriteOffer(e){return this._apiService.post(`user/favourites/${e}/add`,{}).pipe((0,a.M)(()=>{this._offersStore.update({allOffers:this._offersStore.getValue().allOffers.map(r=>({...r,isSaved:r._id===e||r.isSaved}))})}))}removeFavoriteOffer(e){return this._apiService.delete(`user/favourites/${e}/remove`).pipe((0,a.M)(()=>{const{savedOffers:r,allOffers:n}=this._offersQuery.getValue();this._offersStore.update({savedOffers:r.filter(u=>u._id!==e),allOffers:n.map(u=>({...u,isSaved:u._id!==e&&u.isSaved}))})}))}approveOffer(e){return this._apiService.post(`offer/${e}/adminApprovalOffer`,{})}declineOffer(e){return this._apiService.post(`offer/${e}/adminRejectionOffer`,{})}updateOffersList(e){this.getOffers(e).pipe((0,_.$)()).subscribe(r=>{this.offersSource.next(r.rfqList)})}static#e=this.\u0275fac=function(r){return new(r||c)(s.KVO(S.G),s.KVO(f.e),s.KVO(d.B))};static#t=this.\u0275prov=s.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}return c})()},17691:(p,l,t)=>{t.d(l,{e:()=>i});var a=t(35706),o=t(54438),_=t(21638);let i=(()=>{class s extends a.XK{constructor(f){super(f),this.store=f,this.selectAllOffers$=this.select("allOffers"),this.selectMyOffers$=this.select("myOffers"),this.selectOffer$=this.select("offer"),this.selectSavedOffers$=this.select("savedOffers"),this.selectAllOffersCount$=this.select("allOffersCount"),this.selectSeaLines$=this.select("seaLines")}static#e=this.\u0275fac=function(d){return new(d||s)(o.KVO(_.B))};static#t=this.\u0275prov=o.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})()},21638:(p,l,t)=>{t.d(l,{B:()=>s});var a=t(31635),o=t(35706),_=t(54438);let s=class E extends o.il{constructor(){super({allOffers:[],myOffers:[],offer:null,savedOffers:[],allOffersCount:0,seaLines:[]})}static#e=this.\u0275fac=function(d){return new(d||E)};static#t=this.\u0275prov=_.jDH({token:E,factory:E.\u0275fac,providedIn:"root"})};s=(0,a.Cg)([(0,o.g7)({name:"offers"})],s)},54843:(p,l,t)=>{t.d(l,{_:()=>_});var a=t(9350),o=t(47707);function _(i,s){const S="object"==typeof s;return new Promise((f,d)=>{const O=new o.Ms({next:h=>{f(h),O.unsubscribe()},error:d,complete:()=>{S?f(s.defaultValue):d(new a.G)}});i.subscribe(O)})}}}]);