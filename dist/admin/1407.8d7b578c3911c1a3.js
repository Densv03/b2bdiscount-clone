"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[1407],{81407:(y,d,o)=>{o.r(d),o.d(d,{AdminCompaniesModule:()=>j});var a=o(96814),h=o(44112),C=o(66027),f=o(37398),t=o(65879),c=o(56223),s=o(65619),g=o(81374),u=o(87588);let p=(()=>{class e{constructor(n){this.apiService=n,this.adminCompaniesListSource=new s.X(null),this.adminCompaniesCountSource=new s.X(0)}get adminCompaniesList$(){return this.adminCompaniesListSource.asObservable()}get adminCompaniesCount$(){return this.adminCompaniesCountSource.asObservable()}updateAdminCompaniesList(n,i){this.getAdminCompaniesList(n,i).pipe((0,g.P)()).subscribe(l=>{this.adminCompaniesCountSource.next(l.totalCount),this.adminCompaniesListSource.next(l.companies)})}getAdminCompaniesList(n,i){return this.apiService.get("products/get-company",{params:{...n,...i}})}static#t=this.\u0275fac=function(i){return new(i||e)(t.LFG(u.s))};static#n=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var x=o(17856),A=o(11203),m=o(25313),v=o(62033),P=o(26238);function D(e,r){1&e&&(t.TgZ(0,"th",17),t._uU(1,"Name"),t.qZA())}function O(e,r){if(1&e&&(t.TgZ(0,"td",18),t._uU(1),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.Oqu(n.companyName)}}function b(e,r){1&e&&(t.TgZ(0,"th",17),t._uU(1,"Chats count"),t.qZA())}function N(e,r){if(1&e&&(t.TgZ(0,"td",18),t._uU(1),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.Oqu(n.countChats)}}function T(e,r){1&e&&(t.TgZ(0,"th",17),t._uU(1,"Products count"),t.qZA())}function Z(e,r){if(1&e&&(t.TgZ(0,"td",18),t._uU(1),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.Oqu(n.countProducts)}}function F(e,r){1&e&&(t.TgZ(0,"th",17),t._uU(1,"Registration date"),t.qZA())}function M(e,r){if(1&e&&(t.TgZ(0,"td",18),t._uU(1),t.ALo(2,"date"),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,n.createdAt))}}function S(e,r){1&e&&t._UZ(0,"tr",19)}function L(e,r){1&e&&t._UZ(0,"tr",20)}function w(e,r){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",6),t._uU(2),t.qZA(),t.TgZ(3,"table",7),t.ALo(4,"async"),t.ynx(5,8),t.YNc(6,D,2,0,"th",9),t.YNc(7,O,2,1,"td",10),t.BQk(),t.ynx(8,11),t.YNc(9,b,2,0,"th",9),t.YNc(10,N,2,1,"td",10),t.BQk(),t.ynx(11,12),t.YNc(12,T,2,0,"th",9),t.YNc(13,Z,2,1,"td",10),t.BQk(),t.ynx(14,13),t.YNc(15,F,2,0,"th",9),t.YNc(16,M,3,3,"td",10),t.BQk(),t.YNc(17,S,1,0,"tr",14),t.YNc(18,L,1,0,"tr",15),t.qZA(),t.TgZ(19,"b2b-ngx-pagination",16),t.NdJ("togglePageNumber",function(l){t.CHM(n);const _=t.oxw();return t.KtG(_.togglePage(l))}),t.qZA(),t.BQk()}if(2&e){const n=r.ngIf,i=t.oxw();t.xp6(2),t.hij(" Total companies count: ",n," "),t.xp6(1),t.Q6J("dataSource",t.lcZ(4,6,i.adminCompaniesList$)),t.xp6(14),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("length",n)("perPage",i.productsLimit)}}function Q(e,r){1&e&&(t.TgZ(0,"h3"),t._uU(1,"No companies found"),t.qZA())}const U=[{path:"",component:(()=>{class e{constructor(n,i){this.fb=n,this.adminCompaniesService=i,this.b2bNgxInputThemeEnum=C.T,this.productsLimit=20,this.filtersForm=this.fb.group({q:null,registrationDate:this.fb.control({startDate:new Date((new Date).setFullYear((new Date).getFullYear()-1)).toISOString(),endDate:new Date(Date.now()).toISOString()}),country:[null]}),this.adminCompaniesCount$=this.adminCompaniesService.adminCompaniesCount$,this.adminCompaniesList$=this.adminCompaniesService.adminCompaniesList$,this.displayedColumns=["companyName","countChats","countProducts","createdAt"],this.currentFilters=null,this.filteredQueryObj={limit:this.productsLimit,offset:0}}ngOnInit(){this.updateCompaniesListOnFiltersChange(),this.filtersForm.get("registrationDate").updateValueAndValidity()}removeFalsyKeysFromObject(n){for(const i in n)n[i]||delete n[i];return n}updateCompaniesListOnFiltersChange(){this.filtersForm.valueChanges.pipe((0,f.U)(n=>{if(n.registrationDate.startDate){const i=new Date(n.registrationDate.startDate);n.registrationDate.startDate=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate())).toISOString()}return n.registrationDate.endDate&&(n.registrationDate.endDate=new Date(n.registrationDate.endDate).toISOString()),n.q||delete n.q,n.active=!0,n.dateFrom=n.registrationDate.startDate,n.dateTo=n.registrationDate.endDate,delete n.registrationDate,n})).subscribe(n=>{this.onFiltersChange(),this.adminCompaniesService.updateAdminCompaniesList(this.filteredQueryObj,{...this.removeFalsyKeysFromObject(n)}),this.currentFilters=n})}togglePage(n){this.filteredQueryObj={...this.filteredQueryObj,offset:(n-1)*this.productsLimit},this.adminCompaniesService.updateAdminCompaniesList(this.filteredQueryObj,{...this.currentFilters})}onFiltersChange(){this.filteredQueryObj={limit:this.productsLimit,offset:0},this.currentFilters=null}static#t=this.\u0275fac=function(i){return new(i||e)(t.Y36(c.qu),t.Y36(p))};static#n=this.\u0275cmp=t.Xpm({type:e,selectors:[["b2b-admin-companies"]],decls:8,vars:8,consts:[[3,"formGroup"],["type","text","b2bNgxInput","","placeholder","Enter company name","label","Company name","formControlName","q",1,"mb-3",3,"theme"],["b2bNgxInput","","ngxDaterangepickerMd","","label","Registration Time","type","text","placeholder","Select range of date","name","daterange","formControlName","registrationDate",1,"mb-3",3,"theme","showClearButton"],["formControlName","country","placeholder","Select Country"],[4,"ngIf","ngIfElse"],["noCompanies",""],[1,"total-count"],["mat-table","",1,"mat-elevation-z8","w-100","mt-4",3,"dataSource"],["matColumnDef","companyName"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","countChats"],["matColumnDef","countProducts"],["matColumnDef","createdAt"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"length","perPage","togglePageNumber"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(i,l){if(1&i&&(t.TgZ(0,"form",0),t._UZ(1,"input",1)(2,"input",2)(3,"b2b-ngx-country-select",3),t.qZA(),t.YNc(4,w,20,8,"ng-container",4),t.ALo(5,"async"),t.YNc(6,Q,2,0,"ng-template",null,5,t.W1O)),2&i){const _=t.MAs(7);t.Q6J("formGroup",l.filtersForm),t.xp6(1),t.Q6J("theme",l.b2bNgxInputThemeEnum.BACKGROUND_WHITE),t.xp6(1),t.Q6J("theme",l.b2bNgxInputThemeEnum.BACKGROUND_WHITE)("showClearButton",!0),t.xp6(2),t.Q6J("ngIf",t.lcZ(5,6,l.adminCompaniesCount$))("ngIfElse",_)}},dependencies:[a.O5,x.k,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,A.Q,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,v.V,P.SP,a.Ov,a.uU],styles:["[_nghost-%COMP%]   .total-count[_ngcontent-%COMP%]{background:white;padding:15px;margin-top:25px}[_nghost-%COMP%]     th, [_nghost-%COMP%]     td{vertical-align:middle}"]})}return e})()}];let B=(()=>{class e{static#t=this.\u0275fac=function(i){return new(i||e)};static#n=this.\u0275mod=t.oAB({type:e});static#e=this.\u0275inj=t.cJS({imports:[h.Bz.forChild(U),h.Bz]})}return e})();var I=o(82242),Y=o(89611),E=o(98653),J=o(80150);let j=(()=>{class e{static#t=this.\u0275fac=function(i){return new(i||e)};static#n=this.\u0275mod=t.oAB({type:e});static#e=this.\u0275inj=t.cJS({imports:[a.ez,B,I.r,c.UX,Y.z,E.w,m.p0,J.N,P.n1.forRoot()]})}return e})()},11203:(y,d,o)=>{o.d(d,{Q:()=>f});var a=o(65879),h=o(96814);function C(t,c){if(1&t){const s=a.EpF();a.TgZ(0,"li",2),a.NdJ("click",function(){const p=a.CHM(s).$implicit,x=a.oxw();return a.KtG(x.togglePage(p.value))}),a._uU(1),a.qZA()}if(2&t){const s=c.$implicit,g=a.oxw();a.ekj("active",g.currentPage===s.label),a.xp6(1),a.hij(" ",s.label," ")}}let f=(()=>{class t{constructor(){this.currentPage=1,this.togglePageNumber=new a.vpe,this.currentPage=1,this.togglePage(1)}get options(){return this.length&&this.perPage?new Array(Math.ceil(this.length/this.perPage)).fill(null).map((u,p)=>({label:p+1,value:p+1})):[]}togglePage(s){s!==this.currentPage&&(this.currentPage=s,this.togglePageNumber.emit(s))}togglePrevPage(){1!==this.currentPage&&(this.currentPage=this.currentPage-1,this.togglePageNumber.emit(this.currentPage))}toggleNextPage(){this.currentPage!==this.options.length&&(this.currentPage=this.currentPage+1,this.togglePageNumber.emit(this.currentPage))}static#t=this.\u0275fac=function(g){return new(g||t)};static#n=this.\u0275cmp=a.Xpm({type:t,selectors:[["b2b-ngx-pagination"]],inputs:{length:"length",perPage:"perPage",currentPage:"currentPage"},outputs:{togglePageNumber:"togglePageNumber"},decls:2,vars:1,consts:[[1,"ngx-pagination"],["class","ngx-pagination-item",3,"active","click",4,"ngFor","ngForOf"],[1,"ngx-pagination-item",3,"click"]],template:function(g,u){1&g&&(a.TgZ(0,"ul",0),a.YNc(1,C,2,3,"li",1),a.qZA()),2&g&&(a.xp6(1),a.Q6J("ngForOf",u.options))},dependencies:[h.sg],styles:["[_nghost-%COMP%]   ul[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{background-color:#005dff;color:#fff}.ngx-pagination[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;margin-top:24px;flex-wrap:wrap;row-gap:10px}.ngx-pagination[_ngcontent-%COMP%]   .ngx-pagination-item[_ngcontent-%COMP%]{width:40px;height:40px;display:flex;align-items:center;justify-content:center;margin:0 4px;border:1px solid #dfe8f5;cursor:pointer}.ngx-pagination[_ngcontent-%COMP%]   .ngx-pagination-item[_ngcontent-%COMP%]:hover:not(.active){background-color:#eff4fa}.ngx-pagination[_ngcontent-%COMP%]   .ngx-pagination-item[_ngcontent-%COMP%]:active{background:#ffffff}.ngx-pagination[_ngcontent-%COMP%]   .ngx-pagination-item[_ngcontent-%COMP%]:first-child{margin-left:0}.ngx-pagination[_ngcontent-%COMP%]   .ngx-pagination-item[_ngcontent-%COMP%]:last-child{margin-right:0}"],changeDetection:0})}return t})()}}]);