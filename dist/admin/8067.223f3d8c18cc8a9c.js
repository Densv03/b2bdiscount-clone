"use strict";(self.webpackChunkadmin=self.webpackChunkadmin||[]).push([[8067],{48067:(tt,v,i)=>{i.r(v),i.d(v,{AdminArticleModule:()=>q});var p=i(96814),h=i(44112),M=i(97582),P=i(83620),T=i(93997),S=i(27921),A=i(94664),b=i(32181),Z=i(37398),N=i(87046),c=i(56223),B=i(48530),g=i(51791),G=i(52572),L=i(16481),s=i(86825),t=i(65879),E=i(6255),U=i(27171),I=i(58133),J=i(34624),R=i(96506),j=i(88657),Q=i(83498),F=i(62033),y=i(60420),Y=i(61796),O=i(94119);function z(o,x){1&o&&(t.TgZ(0,"p",18),t._uU(1," This field is required "),t.qZA()),2&o&&t.Q6J("@fadeInOut",void 0)}const V={editable:!0,spellcheck:!0,height:"auto",minHeight:"200px",translate:"yes",enableToolbar:!0,showToolbar:!0,placeholder:"Enter text here...",fonts:[{class:"arial",name:"Arial"},{class:"times-new-roman",name:"Times New Roman"},{class:"calibri",name:"Calibri"},{class:"comic-sans-ms",name:"Comic Sans MS"}],sanitize:!0,toolbarPosition:"top"};function _(o,x,a){Object.entries(x).forEach(([n,e])=>{if(Array.isArray(e))e.filter(r=>!!r).forEach(r=>{o.append(n,r)});else if("image"===n)Array.from(e).forEach(r=>{o.append(n,r)});else if("object"==typeof e&&null!==e)_(o,e,n);else{const r=a?`${a}${(0,L.f)(n)}`:n;o.append(r,e)}})}const $=[{path:"",component:(()=>{let o=class f{constructor(a,n,e,r,d){this._formBuilder=a,this._categoriesService=n,this._wikiService=e,this._hotToastService=r,this._activatedRoute=d,this.searchControl=new c.NI,this.b2bNgxSelectThemeEnum=N.B,this.b2bNgxButtonThemeEnum=B.n,this.editorConfig=V,this.formGroup=this.getFormGroup(),this.level1Categories=[],this.level2Categories=[],this.searchedOptions$=this.getSearchedOptions()}getSearchedOptions(){return this.searchControl.valueChanges.pipe((0,P.b)(1e3),(0,T.x)(),(0,S.O)(""),(0,A.w)(a=>this._wikiService.getTags(a)))}setSearch(a){this.searchControl.setValue(a)}setLevel1Categories(){this._categoriesService.getWikiCategories().pipe((0,g.t)(this)).subscribe(a=>{this.level1Categories=a})}setLevel2Categories(){this.formGroup.get("level1Category").valueChanges.pipe((0,g.t)(this),(0,b.h)(a=>!!a)).subscribe(a=>{this.level2Categories=this.level1Categories.find(n=>n._id===a)?.children})}updateArticle(){const a=this._activatedRoute.paramMap.pipe((0,Z.U)(e=>e.get("id")),(0,b.h)(e=>!!e),(0,A.w)(e=>this._wikiService.getArticleById(e))),n=this._categoriesService.getWikiCategories();(0,G.a)([a,n]).pipe((0,g.t)(this)).subscribe(([e,r])=>{const d=e.category?._id,u=r.find(C=>C?.children.find(l=>l._id===d))?._id;this.formGroup.patchValue({...e,image:[e.image],level1Category:u,level2Category:d})})}ngOnInit(){this.updateArticle(),this.setLevel1Categories(),this.setLevel2Categories()}getFormGroup(){return this._formBuilder.group({_id:null,title:["",c.kI.required],description:"",author:"",image:"",country:[null],tags:[[]],level1Category:[null],level2Category:[null]})}onSubmit(a){if("INVALID"===this.formGroup.status)return;const n=new FormData,{_id:e,level1Category:r,level2Category:d,tags:u,...C}=a,l={...C,category:d??r,tags:u.map(m=>m._id||m.name)};for(const m in l)(!l[m]||Array.isArray(l[m])&&!l[m].length)&&delete l[m];l.image=l.image[0],e?this._wikiService.updateArticle(e,l).pipe((0,g.t)(this),this._hotToastService.observe({loading:"Article updating...",success:"Article updated successfully!",error:"Article updating failed!"})).subscribe(()=>{}):(_(n,l),this._wikiService.createArticle(n).pipe((0,g.t)(this),this._hotToastService.observe({loading:"Article creating...",success:"Article created successfully!",error:"Article creation failed!"})).subscribe(()=>{}))}static#t=this.\u0275fac=function(n){return new(n||f)(t.Y36(c.qu),t.Y36(E.G),t.Y36(U.t),t.Y36(I.jE),t.Y36(h.gz))};static#e=this.\u0275cmp=t.Xpm({type:f,selectors:[["b2b-admin-article"]],decls:26,vars:20,consts:[[1,"admin-article",3,"formGroup","ngSubmit"],[1,"admin-article__label"],["formControlName","image",1,"admin-article__image"],[1,"admin-article__main"],["formControlName","title","placeholder","Enter article label",1,"admin-article__input",3,"label"],["class","error",4,"ngIf"],["formControlName","author","placeholder","Enter article author",1,"admin-article__input",3,"label"],[1,"admin-article__categories"],[1,"admin-article__category"],["formControlName","level1Category","placeholder","Select category","bindValue","_id","bindLabel","name",3,"options","theme"],[1,"admin-article__sub-category"],["formControlName","level2Category","placeholder","Select subcategory","bindValue","_id","bindLabel","name",3,"options","theme"],[1,"admin-article__additional"],["formControlName","country","placeholder","Select Country",1,"admin-article__country",3,"theme"],[1,"admin-article__tags"],["formControlName","tags",3,"searchedOptions","searched"],["formControlName","description",1,"admin-article__description",3,"config"],["b2bNgxButton","",1,"admin-article__button",3,"theme"],[1,"error"]],template:function(n,e){1&n&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return e.onSubmit(e.formGroup.value)}),t.TgZ(1,"p",1),t._uU(2),t.qZA(),t.TgZ(3,"b2b-ngx-file",2),t._uU(4,"Image"),t.qZA(),t.TgZ(5,"div",3)(6,"div"),t._UZ(7,"b2b-ngx-input",4),t.ALo(8,"translate"),t.YNc(9,z,2,1,"p",5),t.qZA(),t.TgZ(10,"div"),t._UZ(11,"b2b-ngx-input",6),t.ALo(12,"translate"),t.qZA()(),t.TgZ(13,"div",7)(14,"div",8),t._UZ(15,"b2b-ngx-select",9),t.qZA(),t.TgZ(16,"div",10),t._UZ(17,"b2b-ngx-select",11),t.qZA()(),t.TgZ(18,"div",12),t._UZ(19,"b2b-ngx-country-select",13),t.TgZ(20,"div",14)(21,"b2b-ngx-chips",15),t.NdJ("searched",function(d){return e.setSearch(d)}),t.ALo(22,"async"),t.qZA()()(),t._UZ(23,"angular-editor",16),t.TgZ(24,"button",17),t._uU(25),t.qZA()()),2&n&&(t.Q6J("formGroup",e.formGroup),t.xp6(2),t.hij(" ",e.formGroup.get("_id").value?"Edit an article":"Add an article"," "),t.xp6(5),t.Q6J("label",t.lcZ(8,14,"LABELS.ARTICLE_LABEL")),t.xp6(2),t.Q6J("ngIf",null==e.formGroup.get("title").errors?null:e.formGroup.get("title").errors.required),t.xp6(2),t.Q6J("label",t.lcZ(12,16,"LABELS.ARTICLE_AUTHOR")),t.xp6(4),t.Q6J("options",e.level1Categories)("theme",e.b2bNgxSelectThemeEnum.BACKGROUND_GRAY),t.xp6(2),t.Q6J("options",e.level2Categories)("theme",e.b2bNgxSelectThemeEnum.BACKGROUND_GRAY),t.xp6(2),t.Q6J("theme",e.b2bNgxSelectThemeEnum.BACKGROUND_GRAY),t.xp6(2),t.Q6J("searchedOptions",t.lcZ(22,18,e.searchedOptions$)),t.xp6(2),t.Q6J("config",e.editorConfig),t.xp6(1),t.Q6J("theme",e.b2bNgxButtonThemeEnum.BACKGROUND_BLACK),t.xp6(1),t.hij(" ",e.formGroup.get("_id").value?"Update an article":"Create an article"," "))},dependencies:[p.O5,J.F,R.d,j.B,Q.f,F.V,y.s6,c._Y,c.JJ,c.JL,c.sg,c.u,Y.L,p.Ov,O.X$],styles:[".admin-article[_ngcontent-%COMP%]{display:block;margin:30px;background-color:#fff;padding:60px}.admin-article[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{font-size:14px;color:#e63d3d;margin-top:7px;margin-bottom:0}.admin-article[_ngcontent-%COMP%]   .admin-article__image[_ngcontent-%COMP%]{display:block;margin-top:30px}.admin-article[_ngcontent-%COMP%]   .admin-article__label[_ngcontent-%COMP%]{font-weight:700;font-size:32px;color:#0f0f11}.admin-article[_ngcontent-%COMP%]   .admin-article__input[_ngcontent-%COMP%]{display:block;margin-top:30px}.admin-article[_ngcontent-%COMP%]   .admin-article__main[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.admin-article[_ngcontent-%COMP%]   .admin-article__main[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:49%}.admin-article[_ngcontent-%COMP%]   .admin-article__main[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   .admin-article__input[_ngcontent-%COMP%]{width:100%}.admin-article[_ngcontent-%COMP%]   .admin-article__additional[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:30px}.admin-article[_ngcontent-%COMP%]   .admin-article__additional[_ngcontent-%COMP%]   .admin-article__country[_ngcontent-%COMP%], .admin-article[_ngcontent-%COMP%]   .admin-article__additional[_ngcontent-%COMP%]   .admin-article__tags[_ngcontent-%COMP%]{width:49%}.admin-article[_ngcontent-%COMP%]   .admin-article__categories[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:30px}.admin-article[_ngcontent-%COMP%]   .admin-article__categories[_ngcontent-%COMP%]   .admin-article__category[_ngcontent-%COMP%], .admin-article[_ngcontent-%COMP%]   .admin-article__categories[_ngcontent-%COMP%]   .admin-article__sub-category[_ngcontent-%COMP%]{width:49%}.admin-article[_ngcontent-%COMP%]   .admin-article__button[_ngcontent-%COMP%]{margin-top:30px;padding:15px 40px}  .angular-editor-textarea img{max-width:100%}  .angular-editor-textarea p{line-height:24px}  .admin-article__description{display:block;margin-top:30px;overflow:hidden;line-height:24px}  .admin-article__description span,   .admin-article__description p{line-height:24px}  .admin-article__description ul,   .admin-article__description li{list-style:disc!important}  .admin-article__description ul{padding-left:30px}  .admin-article__description strong,   .admin-article__description b{font-weight:700!important}  .admin-article__description img{width:100%}"],data:{animation:[(0,s.X$)("fadeInOut",[(0,s.eR)(":enter",[(0,s.oB)({opacity:0}),(0,s.jt)(500,(0,s.oB)({opacity:1}))]),(0,s.eR)(":leave",[(0,s.jt)(500,(0,s.oB)({opacity:0}))])])]},changeDetection:0})};return o=(0,M.gn)([(0,g.c)()],o),o})()}];let D=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275mod=t.oAB({type:o});static#i=this.\u0275inj=t.cJS({imports:[h.Bz.forChild($),h.Bz]})}return o})();var K=i(82242),X=i(28514),W=i(74027),H=i(43377),w=i(80150),k=i(38625);let q=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275mod=t.oAB({type:o});static#i=this.\u0275inj=t.cJS({imports:[p.ez,D,K.r,X.y,W.F,H.l,w.N,y.UM,c.UX,k.v,O.aw]})}return o})()}}]);