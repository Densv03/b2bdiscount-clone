{"version":3,"file":"src_app_client_services_categories_categories_service_ts.js","mappings":"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","sources":["./src/app/client/services/categories/categories.service.ts","./src/app/client/state/categories/categories.query.ts","./src/app/client/state/categories/categories.store.ts"],"sourcesContent":["import { Injectable } from \"@angular/core\";\n\nimport { Observable, takeWhile } from \"rxjs\";\nimport {first, map} from \"rxjs/operators\";\n\nimport {ApiService} from \"../../../core/services/api/api.service\";\nimport {CategoriesQuery} from \"../../state/categories/categories.query\";\nimport {CategoriesStore} from \"../../state/categories/categories.store\";\n\n@Injectable({\n\tprovidedIn: \"root\",\n})\nexport class CategoriesService {\n\tpublic readonly endpoint: string;\n\n\tconstructor(\n\t\tprivate readonly _apiService: ApiService,\n\t\tprivate readonly _categoriesStore: CategoriesStore,\n\t\tprivate readonly _categoriesQuery: CategoriesQuery\n\t) {\n\t\tthis.endpoint = \"categories/\";\n\t\tthis.getCategories$();\n\t}\n\n\tpublic getCategories$(): Observable<any> {\n\t\tconst { categories } = this._categoriesQuery.getValue();\n\t\tif (!categories?.categories?.length || !categories?.totalCount) {\n\t\t\tthis._apiService\n\t\t\t\t.get(this.endpoint)\n\t\t\t\t.subscribe((categories: any) => {\n\t\t\t\t\tthis._categoriesStore.update({\n\t\t\t\t\t\tcategories\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t}\n\n\t\treturn this._categoriesQuery.selectCategories$;\n\t}\n\n\tpublic getCategories(): any {\n\t\tconst {categories} = this._categoriesQuery.getValue();\n\t\tif (!categories) {\n\t\t\treturn [];\n\t\t}\n\t\treturn this._categoriesQuery.getValue();\n\t}\n\n\tpublic updateCategory(id: any, name: any, hide: any) {\n\t\treturn this._apiService.put(`category/${id}/update`, {\n\t\t\t...(name ? { name } : {}),\n\t\t\thide,\n\t\t});\n\t}\n\n\tpublic createCategory(level1Category: any, level2Category: any, level3Category: any) {\n\t\treturn this._apiService.post(`category/create`, {\n\t\t\tcategory: {\n\t\t\t\t...level1Category,\n\t\t\t\tcategory: {\n\t\t\t\t\t...level2Category,\n\t\t\t\t\tcategory: level3Category,\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\tpublic updateWikiCategory(id: any, name: any, hide: any) {\n\t\treturn this._apiService.put(`categoryPost/${id}/update`, {\n\t\t\t...(name ? { name } : {}),\n\t\t\thide: !hide,\n\t\t});\n\t}\n\n\tpublic createWikiCategory(level1Category: any, level2Category: any) {\n\t\treturn this._apiService.post(`categoryPost/create`, {\n\t\t\tcategory: {\n\t\t\t\t...level1Category,\n\t\t\t\tcategory: level2Category,\n\t\t\t},\n\t\t});\n\t}\n\n\tpublic getWikiCategories() {\n\t\tconst { wikiCategories } = this._categoriesQuery.getValue();\n\n\t\tif (!wikiCategories.length) {\n\t\t\tthis._apiService\n\t\t\t\t.get(\"categoryPosts\")\n\t\t\t\t.subscribe((response: any) => {\n\t\t\t\t\tthis._categoriesStore.update({\n\t\t\t\t\t\twikiCategories: response,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t}\n\n\t\treturn this._categoriesQuery.selectWikiCategories$;\n\t}\n\n\tpublic getCategoryNameById(categoryId: string): Observable<string> {\n\t\treturn this.getCategories$().pipe(\n\t\t\ttakeWhile(({ categories }) => !categories.length, true),\n\t\t\tmap(({ categories }) => {\n\t\t\t\tfor (const parentCategory of categories) {\n\t\t\t\t\tif (parentCategory._id === categoryId) {\n\t\t\t\t\t\treturn parentCategory.name\n\t\t\t\t\t}\n\t\t\t\t\tfor (const childCategory of parentCategory.children) {\n\t\t\t\t\t\tif (childCategory._id === categoryId) {\n\t\t\t\t\t\t\treturn childCategory.name;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}),\n\t\t);\n\t}\n}\n","import { Injectable } from \"@angular/core\";\nimport { Query } from \"@datorama/akita\";\nimport { Observable } from \"rxjs\";\nimport {CategoriesState, CategoriesStore} from \"./categories.store\";\n\n@Injectable({ providedIn: \"root\" })\nexport class CategoriesQuery extends Query<CategoriesState> {\n\tpublic readonly selectCategories$: Observable<any>;\n\tpublic readonly selectWikiCategories$: Observable<any>;\n\tconstructor(protected override store: CategoriesStore) {\n\t\tsuper(store);\n\n\t\tthis.selectCategories$ = this.select(\"categories\");\n\t\tthis.selectWikiCategories$ = this.select(\"wikiCategories\");\n\t}\n}\n","import { Injectable } from \"@angular/core\";\nimport { Store, StoreConfig } from \"@datorama/akita\";\n\nexport interface CategoriesState {\n\tcategories: any;\n\twikiCategories: any;\n}\n\nexport function createInitialState(): CategoriesState {\n\treturn {\n\t\tcategories: {\n\t\t\tcategories: [],\n\t\t\ttotalCount: 0,\n\t\t},\n\t\twikiCategories: [],\n\t};\n}\n\n@Injectable({ providedIn: \"root\" })\n@StoreConfig({ name: \"categories\" })\nexport class CategoriesStore extends Store<CategoriesState> {\n\tconstructor() {\n\t\tsuper(createInitialState());\n\t}\n}\n"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}