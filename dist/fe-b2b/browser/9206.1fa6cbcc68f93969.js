"use strict";(self.webpackChunkfe_b2b=self.webpackChunkfe_b2b||[]).push([[9206],{99206:(tt,C,e)=>{e.r(C),e.d(C,{AdminArticleModule:()=>k});var v=e(69808),f=e(63807),x=e(97582),M=e(78372),P=e(71884),T=e(68675),A=e(63900),b=e(39300),S=e(54004),Z=e(20592),d=e(93075),N=e(14739),p=e(44987),B=e(39841),G=e(2613),m=e(41777),t=e(5e3),L=e(26402),E=e(35551),U=e(56913),R=e(21729),I=e(97567),J=e(13114),j=e(5214),Q=e(11070),y=e(29345),F=e(29291),O=e(19129);function Y(o,n){1&o&&(t.TgZ(0,"p",18),t._uU(1," This field is required "),t.qZA()),2&o&&t.Q6J("@fadeInOut",void 0)}const z={editable:!0,spellcheck:!0,height:"auto",minHeight:"200px",translate:"yes",enableToolbar:!0,showToolbar:!0,placeholder:"Enter text here...",fonts:[{class:"arial",name:"Arial"},{class:"times-new-roman",name:"Times New Roman"},{class:"calibri",name:"Calibri"},{class:"comic-sans-ms",name:"Comic Sans MS"}],sanitize:!0,toolbarPosition:"top"};function _(o,n,i){Object.entries(n).forEach(([a,l])=>{if(Array.isArray(l))l.filter(r=>!!r).forEach(r=>{o.append(a,r)});else if("image"===a)Array.from(l).forEach(r=>{o.append(a,r)});else if("object"==typeof l&&null!==l)_(o,l,a);else{const r=i?`${i}${(0,G.f)(a)}`:a;o.append(r,l)}})}let g=class{constructor(n,i,a,l,r){this._formBuilder=n,this._categoriesService=i,this._wikiService=a,this._hotToastService=l,this._activatedRoute=r,this.searchControl=new d.NI,this.b2bNgxSelectThemeEnum=Z.B,this.b2bNgxButtonThemeEnum=N.n,this.editorConfig=z,this.formGroup=this.getFormGroup(),this.level1Categories=[],this.level2Categories=[],this.searchedOptions$=this.getSearchedOptions()}getSearchedOptions(){return this.searchControl.valueChanges.pipe((0,M.b)(1e3),(0,P.x)(),(0,T.O)(""),(0,A.w)(n=>this._wikiService.getTags(n)))}setSearch(n){this.searchControl.setValue(n)}setLevel1Categories(){this._categoriesService.getWikiCategories().pipe((0,p.t)(this)).subscribe(n=>{this.level1Categories=n})}setLevel2Categories(){this.formGroup.get("level1Category").valueChanges.pipe((0,p.t)(this),(0,b.h)(n=>!!n)).subscribe(n=>{var i;this.level2Categories=null===(i=this.level1Categories.find(a=>a._id===n))||void 0===i?void 0:i.children})}updateArticle(){const n=this._activatedRoute.paramMap.pipe((0,S.U)(a=>a.get("id")),(0,b.h)(a=>!!a),(0,A.w)(a=>this._wikiService.getArticleById(a))),i=this._categoriesService.getWikiCategories();(0,B.a)([n,i]).pipe((0,p.t)(this)).subscribe(([a,l])=>{var r,u;const h=null===(r=a.category)||void 0===r?void 0:r._id,c=null===(u=l.find(s=>null==s?void 0:s.children.find(q=>q._id===h)))||void 0===u?void 0:u._id;this.formGroup.patchValue({...a,image:[a.image],level1Category:c,level2Category:h})})}ngOnInit(){this.updateArticle(),this.setLevel1Categories(),this.setLevel2Categories()}getFormGroup(){return this._formBuilder.group({_id:null,title:["",d.kI.required],description:"",author:"",image:"",country:[null],tags:[[]],level1Category:[null],level2Category:[null]})}onSubmit(n){if("INVALID"===this.formGroup.status)return;const i=new FormData,{_id:a,level1Category:l,level2Category:r,tags:u,...h}=n,c={...h,category:null!=r?r:l,tags:u.map(s=>s._id||s.name)};for(const s in c)(!c[s]||Array.isArray(c[s])&&!c[s].length)&&delete c[s];c.image=c.image[0],a?this._wikiService.updateArticle(a,c).pipe((0,p.t)(this),this._hotToastService.observe({loading:"Article updating...",success:"Article updated successfully!",error:"Article updating failed!"})).subscribe(()=>{}):(_(i,c),this._wikiService.createArticle(i).pipe((0,p.t)(this),this._hotToastService.observe({loading:"Article creating...",success:"Article created successfully!",error:"Article creation failed!"})).subscribe(()=>{}))}};g.\u0275fac=function(n){return new(n||g)(t.Y36(d.qu),t.Y36(L.G),t.Y36(E.t),t.Y36(U.jE),t.Y36(f.gz))},g.\u0275cmp=t.Xpm({type:g,selectors:[["b2b-admin-article"]],decls:26,vars:20,consts:[[1,"admin-article",3,"formGroup","ngSubmit"],[1,"admin-article__label"],["formControlName","image",1,"admin-article__image"],[1,"admin-article__main"],["formControlName","title","placeholder","Enter article label",1,"admin-article__input",3,"label"],["class","error",4,"ngIf"],["formControlName","author","placeholder","Enter article author",1,"admin-article__input",3,"label"],[1,"admin-article__categories"],[1,"admin-article__category"],["formControlName","level1Category","placeholder","Select category","bindValue","_id","bindLabel","name",3,"options","theme"],[1,"admin-article__sub-category"],["formControlName","level2Category","placeholder","Select subcategory","bindValue","_id","bindLabel","name",3,"options","theme"],[1,"admin-article__additional"],["formControlName","country","placeholder","Select Country",1,"admin-article__country",3,"theme"],[1,"admin-article__tags"],["formControlName","tags",3,"searchedOptions","searched"],["formControlName","description",1,"admin-article__description",3,"config"],["b2bNgxButton","",1,"admin-article__button",3,"theme"],[1,"error"]],template:function(n,i){1&n&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return i.onSubmit(i.formGroup.value)}),t.TgZ(1,"p",1),t._uU(2),t.qZA(),t.TgZ(3,"b2b-ngx-file",2),t._uU(4,"Image"),t.qZA(),t.TgZ(5,"div",3)(6,"div"),t._UZ(7,"b2b-ngx-input",4),t.ALo(8,"translate"),t.YNc(9,Y,2,1,"p",5),t.qZA(),t.TgZ(10,"div"),t._UZ(11,"b2b-ngx-input",6),t.ALo(12,"translate"),t.qZA()(),t.TgZ(13,"div",7)(14,"div",8),t._UZ(15,"b2b-ngx-select",9),t.qZA(),t.TgZ(16,"div",10),t._UZ(17,"b2b-ngx-select",11),t.qZA()(),t.TgZ(18,"div",12),t._UZ(19,"b2b-ngx-country-select",13),t.TgZ(20,"div",14)(21,"b2b-ngx-chips",15),t.NdJ("searched",function(l){return i.setSearch(l)}),t.ALo(22,"async"),t.qZA()()(),t._UZ(23,"angular-editor",16),t.TgZ(24,"button",17),t._uU(25),t.qZA()()),2&n&&(t.Q6J("formGroup",i.formGroup),t.xp6(2),t.hij(" ",i.formGroup.get("_id").value?"Edit an article":"Add an article"," "),t.xp6(5),t.Q6J("label",t.lcZ(8,14,"LABELS.ARTICLE_LABEL")),t.xp6(2),t.Q6J("ngIf",null==i.formGroup.get("title").errors?null:i.formGroup.get("title").errors.required),t.xp6(2),t.Q6J("label",t.lcZ(12,16,"LABELS.ARTICLE_AUTHOR")),t.xp6(4),t.Q6J("options",i.level1Categories)("theme",i.b2bNgxSelectThemeEnum.BACKGROUND_GRAY),t.xp6(2),t.Q6J("options",i.level2Categories)("theme",i.b2bNgxSelectThemeEnum.BACKGROUND_GRAY),t.xp6(2),t.Q6J("theme",i.b2bNgxSelectThemeEnum.BACKGROUND_GRAY),t.xp6(2),t.Q6J("searchedOptions",t.lcZ(22,18,i.searchedOptions$)),t.xp6(2),t.Q6J("config",i.editorConfig),t.xp6(1),t.Q6J("theme",i.b2bNgxButtonThemeEnum.BACKGROUND_BLACK),t.xp6(1),t.hij(" ",i.formGroup.get("_id").value?"Update an article":"Create an article"," "))},dependencies:[v.O5,R.F,I.d,J.B,j.f,Q.V,y.s6,d._Y,d.JJ,d.JL,d.sg,d.u,F.L,v.Ov,O.X$],styles:[".admin-article[_ngcontent-%COMP%]{display:block;margin:30px;background-color:#fff;padding:60px}.admin-article[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{font-size:14px;color:#e63d3d;margin-top:7px;margin-bottom:0}.admin-article[_ngcontent-%COMP%]   .admin-article__image[_ngcontent-%COMP%]{display:block;margin-top:30px}.admin-article[_ngcontent-%COMP%]   .admin-article__label[_ngcontent-%COMP%]{font-weight:700;font-size:32px;color:#0f0f11}.admin-article[_ngcontent-%COMP%]   .admin-article__input[_ngcontent-%COMP%]{display:block;margin-top:30px}.admin-article[_ngcontent-%COMP%]   .admin-article__main[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.admin-article[_ngcontent-%COMP%]   .admin-article__main[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:49%}.admin-article[_ngcontent-%COMP%]   .admin-article__main[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   .admin-article__input[_ngcontent-%COMP%]{width:100%}.admin-article[_ngcontent-%COMP%]   .admin-article__additional[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:30px}.admin-article[_ngcontent-%COMP%]   .admin-article__additional[_ngcontent-%COMP%]   .admin-article__country[_ngcontent-%COMP%], .admin-article[_ngcontent-%COMP%]   .admin-article__additional[_ngcontent-%COMP%]   .admin-article__tags[_ngcontent-%COMP%]{width:49%}.admin-article[_ngcontent-%COMP%]   .admin-article__categories[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:30px}.admin-article[_ngcontent-%COMP%]   .admin-article__categories[_ngcontent-%COMP%]   .admin-article__category[_ngcontent-%COMP%], .admin-article[_ngcontent-%COMP%]   .admin-article__categories[_ngcontent-%COMP%]   .admin-article__sub-category[_ngcontent-%COMP%]{width:49%}.admin-article[_ngcontent-%COMP%]   .admin-article__button[_ngcontent-%COMP%]{margin-top:30px;padding:15px 40px}  .angular-editor-textarea img{max-width:100%}  .angular-editor-textarea p{line-height:24px}  .admin-article__description{display:block;margin-top:30px;overflow:hidden;line-height:24px}  .admin-article__description span,   .admin-article__description p{line-height:24px}  .admin-article__description ul,   .admin-article__description li{list-style:disc!important}  .admin-article__description ul{padding-left:30px}  .admin-article__description strong,   .admin-article__description b{font-weight:700!important}  .admin-article__description img{width:100%}"],data:{animation:[(0,m.X$)("fadeInOut",[(0,m.eR)(":enter",[(0,m.oB)({opacity:0}),(0,m.jt)(500,(0,m.oB)({opacity:1}))]),(0,m.eR)(":leave",[(0,m.jt)(500,(0,m.oB)({opacity:0}))])])]},changeDetection:0}),g=(0,x.gn)([(0,p.c)()],g);const V=[{path:"",component:g}];let $=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[f.Bz.forChild(V),f.Bz]}),o})();var D=e(94418),K=e(38831),X=e(97631),W=e(59026),H=e(17354),w=e(16749);let k=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[v.ez,$,D.r,K.y,X.F,W.l,H.N,y.UM,d.UX,w.v,O.aw]}),o})()}}]);