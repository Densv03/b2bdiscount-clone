"use strict";(self.webpackChunkfe_b2b=self.webpackChunkfe_b2b||[]).push([[9930],{99930:(Q,p,i)=>{i.r(p),i.d(p,{AdminHomepageModule:()=>O});var d=i(69808),h=i(63807),C=i(97582),x=i(14739),A=i(70771),v=i(54004),f=i(44987),b=i(92340),e=i(5e3),m=i(93075),y=i(26402),N=i(56913),T=i(44876),E=i(5214),B=i(70159),H=i(13114);function J(r,t){if(1&r){const o=e.EpF();e.TgZ(0,"p")(1,"input",11),e.NdJ("click",function(){const a=e.CHM(o).index,c=e.oxw().index,l=e.oxw(2);return e.KtG(l.onInputClick(c,a))}),e.qZA()()}if(2&r){const o=t.index,n=e.oxw().index,s=e.oxw(2);e.xp6(1),e.Tol("url-input-"+n),e.Q6J("theme",s.b2bNgxInputThemeEnum.BACKGROUND_WHITE)("label","Enter url "+s.getLabel(o))}}function S(r,t){if(1&r){const o=e.EpF();e.TgZ(0,"div")(1,"div",7),e._UZ(2,"b2b-ngx-select",8),e.TgZ(3,"button",9),e.NdJ("click",function(){const a=e.CHM(o).index,c=e.oxw(2);return e.KtG(c.toggleCollapse(a))}),e._uU(4),e.qZA(),e.TgZ(5,"button",9),e.NdJ("click",function(){const a=e.CHM(o).index,c=e.oxw(2);return e.KtG(c.removeCategory(a))}),e._uU(6," Remove category "),e.qZA(),e.TgZ(7,"div",10),e.YNc(8,J,2,4,"p",6),e.qZA()()()}if(2&r){const o=t.$implicit,n=t.index,s=e.oxw().ngIf,a=e.oxw();e.xp6(1),e.Q6J("formGroupName",n),e.xp6(1),e.Q6J("options",s),e.xp6(1),e.Q6J("theme",a.b2bNgxButtonThemeEnum.BACKGROUND_BLUE),e.xp6(1),e.hij(" ",o.value.collapsed?"Expand":"Collapse"," "),e.xp6(1),e.Q6J("theme",a.b2bNgxButtonThemeEnum.BACKGROUND_BLUE),e.xp6(2),e.ekj("d-none",!o.value.parentCategory||o.value.collapsed),e.xp6(1),e.Q6J("ngForOf",o.value.productIds)}}function F(r,t){if(1&r&&(e.TgZ(0,"div",5),e.YNc(1,S,9,8,"div",6),e.qZA()),2&r){const o=e.oxw();e.xp6(1),e.Q6J("ngForOf",o.categoriesFormArray.controls)}}let u=class{constructor(t,o,n,s,a){this.fb=t,this.categoriesService=o,this.hotToastService=n,this.elementRef=s,this.homepageService=a,this.b2bNgxButtonThemeEnum=x.n,this.b2bNgxInputThemeEnum=A.T,this.categories$=this.getCategories$(),this.form=this.fb.group({categories:this.fb.array([this.createNewCategory()])})}get categoriesFormArray(){return this.form.get("categories")}ngOnInit(){this.initCarouselCategories()}removeCategory(t){1!==this.categoriesFormArray.length?this.categoriesFormArray.removeAt(t):this.hotToastService.info("You have zero selected categories")}onSave(){var t;const o=[];for(let n=0;n<=6;n++){const s=this.elementRef.nativeElement.querySelectorAll(`.url-input-${n}`),a=null===(t=this.categoriesFormArray.value[n])||void 0===t?void 0:t.parentCategory;if(!a)continue;const c=Array.from(s).filter(l=>l.value&&l.value.includes("b2b.discount")).map(l=>l.value.split("/").pop());c.length>0&&o.push({id:a,products:c})}this.homepageService.updateCarouselItems(o).pipe((0,f.t)(this),this.hotToastService.observe({loading:"Carousel updating...",success:"Carousel updated successfully",error:"Error while updating carousel"})).subscribe()}addCategory(){this.categoriesFormArray.length>=6?this.hotToastService.info("You can't add more then 6 categories"):this.categoriesFormArray.push(this.createNewCategory())}getLabel(t){if(isNaN(+t))throw"Invalid index";return"string"==typeof t?(parseInt(t)+1).toString():(t+1).toString()}toggleCollapse(t){const o=this.categoriesFormArray.value.map((n,s)=>t===s?{...n,collapsed:!n.collapsed}:n);this.categoriesFormArray.setValue(o)}onInputClick(t,o){if(isNaN(+t)||isNaN(+o))throw new Error("Invalid index");let n;n=document.querySelectorAll(`.url-input-${t}`)[o],n.focus(),n.select()}createNewCategory(){return this.fb.group({parentCategory:[],productIds:[Array(12)],collapsed:!0})}getCategories$(){return this.categoriesService.getCategories$().pipe((0,v.U)(t=>t.categories),(0,v.U)(t=>t.map(({name:o,_id:n})=>({name:o,_id:n}))))}initCarouselCategories(){this.homepageService.getCarouselItems().subscribe(t=>{for(let o=0;o<t.length-1;++o)this.addCategory();this.categoriesFormArray.setValue(t.map(o=>({parentCategory:o._id,productIds:Array(12),collapsed:!0}))),setTimeout(()=>{t.forEach((o,n)=>{document.querySelectorAll(`.url-input-${n}`).forEach((s,a)=>{var c,l;const g=(null===(c=t[n].products[a])||void 0===c?void 0:c.path)||(null===(l=t[n].products[a])||void 0===l?void 0:l._id);g&&(s.value=b.N.apiUrl.includes("api-dev")?"dev.b2b.discount/b2bmarket/products/"+g:"b2b.discount/b2bmarket/products/"+g)})})})})}};u.\u0275fac=function(t){return new(t||u)(e.Y36(m.qu),e.Y36(y.G),e.Y36(N.jE),e.Y36(e.SBq),e.Y36(T.g))},u.\u0275cmp=e.Xpm({type:u,selectors:[["b2b-admin-homepage"]],decls:8,vars:6,consts:[[3,"formGroup"],["formArrayName","categories",4,"ngIf"],[1,"d-flex","pt-2"],["b2bNgxButton","",1,"w-50","py-2",3,"theme","click"],["b2bNgxButton","",1,"d-block","w-50","py-2",3,"theme","click"],["formArrayName","categories"],[4,"ngFor","ngForOf"],[1,"d-flex",2,"flex-wrap","wrap",3,"formGroupName"],["placeholder","Select parent category","formControlName","parentCategory","bindValue","_id","bindLabel","name",2,"width","70%",3,"options"],["b2bNgxButton","",2,"width","15%",3,"theme","click"],[1,"w-100"],["type","text","b2bNgxInput","","placeholder","Enter product url ",3,"theme","label","click"]],template:function(t,o){1&t&&(e.TgZ(0,"form",0),e.YNc(1,F,2,1,"div",1),e.ALo(2,"async"),e.TgZ(3,"div",2)(4,"button",3),e.NdJ("click",function(){return o.addCategory()}),e._uU(5," Add category "),e.qZA(),e.TgZ(6,"button",4),e.NdJ("click",function(){return o.onSave()}),e._uU(7," Save changes "),e.qZA()()()),2&t&&(e.Q6J("formGroup",o.form),e.xp6(1),e.Q6J("ngIf",e.lcZ(2,4,o.categories$)),e.xp6(3),e.Q6J("theme",o.b2bNgxButtonThemeEnum.BACKGROUND_BLUE),e.xp6(2),e.Q6J("theme",o.b2bNgxButtonThemeEnum.BACKGROUND_BLUE))},dependencies:[d.sg,d.O5,E.f,B.k,m._Y,m.JJ,m.JL,m.sg,m.u,m.x0,m.CE,H.B,d.Ov]}),u=(0,C.gn)([(0,f.c)()],u);const I=[{path:"",component:u}];let _=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[h.Bz.forChild(I),h.Bz]}),r})();var U=i(59026),Z=i(94418),G=i(97631);let O=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[d.ez,_,U.l,Z.r,m.UX,G.F]}),r})()}}]);