{"version":3,"file":"556.js","mappings":"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","sources":["./src/app/client/pages/client-profile/pages/client-profile-marketplace/components/client-chat/client-chat-routing.module.ts","./src/app/client/pages/client-profile/pages/client-profile-marketplace/components/client-chat/client-chat.module.ts","./src/app/client/pages/client-profile/pages/client-profile-marketplace/components/client-chat/layout/client-chat.component.ts","./src/app/client/pages/client-profile/pages/client-profile-marketplace/components/client-chat/layout/client-chat.component.html","./src/app/client/services/chat/chat.service.ts"],"sourcesContent":["import { NgModule } from \"@angular/core\";\nimport { RouterModule, Routes } from \"@angular/router\";\nimport { ClientChatComponent } from \"./layout/client-chat.component\";\n\nconst routes: Routes = [\n\t{\n\t\tpath: \"\",\n\t\tcomponent: ClientChatComponent,\n\t},\n];\n\n@NgModule({\n\timports: [RouterModule.forChild(routes)],\n\texports: [RouterModule],\n})\nexport class ClientChatRoutingModule {}\n","import { NgModule } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\n\nimport { B2bNgxTextareaModule } from \"@b2b/ngx-textarea\";\nimport { B2bNgxButtonModule } from \"@b2b/ngx-button\";\nimport { B2bNgxImageModule } from \"@b2b/ngx-image\";\nimport { B2bNgxIconModule } from \"@b2b/ngx-icon\";\nimport { ReactiveFormsModule } from \"@angular/forms\";\nimport { ClientChatComponent } from \"./layout/client-chat.component\";\nimport { ClientChatRoutingModule } from \"./client-chat-routing.module\";\nimport { B2bNgxFileModule } from \"@b2b/ngx-file\";\nimport {TranslateModule} from \"@ngx-translate/core\";\n\n@NgModule({\n\tdeclarations: [ClientChatComponent],\n\timports: [\n\t\tCommonModule,\n\t\tClientChatRoutingModule,\n\t\tReactiveFormsModule,\n\t\tB2bNgxTextareaModule,\n\t\tB2bNgxButtonModule,\n\t\tB2bNgxImageModule,\n\t\tB2bNgxIconModule,\n\t\tB2bNgxFileModule,\n\t\tTranslateModule,\n\t],\n})\nexport class ClientChatModule {}\n","import {\n\tChangeDetectionStrategy,\n\tChangeDetectorRef,\n\tComponent,\n\tElementRef,\n\tOnDestroy,\n\tOnInit,\n\tViewChild,\n} from \"@angular/core\";\nimport { B2bNgxButtonThemeEnum } from \"@b2b/ngx-button\";\nimport { ActivatedRoute } from \"@angular/router\";\nimport { UntilDestroy, untilDestroyed } from \"@ngneat/until-destroy\";\nimport { ChatService } from \"../../../../../../../services/chat/chat.service\";\nimport { BehaviorSubject, combineLatest, Observable } from \"rxjs\";\nimport { filter, map, switchMap, tap } from \"rxjs/operators\";\nimport { UserService } from \"../../../../../services/user/user.service\";\nimport { FormBuilder, FormGroup } from \"@angular/forms\";\nimport { io } from \"socket.io-client\";\nimport { AuthService } from \"../../../../../../../../auth/services/auth/auth.service\";\nimport { environment } from \"../../../../../../../../../environments/environment\";\nimport { SocketService } from \"../../../../../../../services/socket/socket.service\";\nimport { ChatsService } from \"../../../../../../../services/chats/chats.service\";\nimport { HotToastService } from \"@ngneat/hot-toast\";\nimport { B2bNgxLinkService } from \"@b2b/ngx-link\";\nimport { getName } from \"country-list\";\nimport mixpanel from \"mixpanel-browser\";\nimport {MixpanelService} from \"../../../../../../../../core/services/mixpanel/mixpanel.service\";\nimport {TranslateService} from \"@ngx-translate/core\";\n\n@UntilDestroy()\n@Component({\n\tselector: \"b2b-client-chat\",\n\ttemplateUrl: \"./client-chat.component.html\",\n\tstyleUrls: [\"./client-chat.component.scss\"],\n\tchangeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class ClientChatComponent implements OnInit, OnDestroy {\n\t@ViewChild(\"chatContainer\") chatContainer: ElementRef;\n\tpublic buyerContacts: any;\n\tpublic buyerStatus: boolean;\n\tpublic rfqInfo: any;\n\n\tpublic readonly formGroup: FormGroup;\n\tpublic readonly b2bNgxButtonThemeEnum: typeof B2bNgxButtonThemeEnum;\n\n\tpublic readonly messages$: Observable<any>;\n\tpublic readonly chatInfo$: Observable<any>;\n\n\tprivate readonly _messagesHistoryBehaviourSubject: BehaviorSubject<any>;\n\tprivate readonly _messagesHistory$: Observable<any>;\n\n\tprivate readonly _messageBehaviourSubject: BehaviorSubject<any>;\n\tprivate readonly _message$: Observable<any>;\n\n\tprivate readonly _chatInfoBehaviourSubject: BehaviorSubject<any>;\n\tprivate readonly _chatInfo$: Observable<any>;\n\n\tpublic chat: any;\n\tpublic displayRequestContacts: boolean;\n\tpublic displayOpenContacts: boolean;\n\tpublic displayCloseContacts: boolean;\n\tpublic displayContactsRequested: boolean;\n\tpublic displayContactsOpened: boolean = true;\n\n\tprivate _socket: any;\n\n\tconstructor(\n\t\tprivate readonly _activatedRoute: ActivatedRoute,\n\t\tprivate readonly _chatService: ChatService,\n\t\tprivate readonly _chatsService: ChatsService,\n\t\tprivate readonly _usersService: UserService,\n\t\tprivate readonly _formBuilder: FormBuilder,\n\t\tprivate readonly _authService: AuthService,\n\t\tprivate readonly _socketService: SocketService,\n\t\tprivate readonly _hotToastService: HotToastService,\n\t\tpublic changeDetectorRef: ChangeDetectorRef,\n\t\tpublic readonly b2bNgxLinkService: B2bNgxLinkService,\n\t\tprivate readonly translateService: TranslateService,\n    private readonly mixpanelService: MixpanelService\n\t) {\n\t\tthis.b2bNgxButtonThemeEnum = B2bNgxButtonThemeEnum;\n\t\tthis.formGroup = this._formBuilder.group({\n\t\t\tmessage: \"\",\n\t\t});\n\n\t\tthis._messagesHistoryBehaviourSubject = new BehaviorSubject<any>([]);\n\t\tthis._messagesHistory$ = this._messagesHistoryBehaviourSubject.asObservable();\n\n\t\tthis._messageBehaviourSubject = new BehaviorSubject<any>([]);\n\t\tthis._message$ = this._messageBehaviourSubject.asObservable();\n\n\t\tthis._chatInfoBehaviourSubject = new BehaviorSubject<any>(null);\n\t\tthis._chatInfo$ = this._chatInfoBehaviourSubject.asObservable();\n\n\t\tthis.chatInfo$ = this.getChatInfo();\n\t\tthis.messages$ = this.getMessages();\n\t}\n\n\tpublic getChatInfo(): Observable<any> {\n\t\treturn this._authService.getUser().pipe(\n\t\t\tfilter((user) => !!user),\n\t\t\tswitchMap((user) => {\n\t\t\t\treturn this._chatInfo$.pipe(\n\t\t\t\t\tfilter((chatInfo) => !!chatInfo),\n\t\t\t\t\tmap((chatInfo) => {\n\t\t\t\t\t\tif (chatInfo.buyer._id === user._id) {\n\t\t\t\t\t\t\tthis.buyerContacts = chatInfo.seller;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.buyerContacts = chatInfo.buyer;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.rfqInfo = chatInfo;\n\t\t\t\t\t\tthis.buyerStatus = chatInfo.isActive;\n\t\t\t\t\t\tconst displayInfoOf =\n\t\t\t\t\t\t\tchatInfo.buyer?._id === user?._id\n\t\t\t\t\t\t\t\t? this.translateService.instant(\"CHAT.SUPPLIER\")\n\t\t\t\t\t\t\t\t: this.translateService.instant(\"CHAT.BUYER\");\n\t\t\t\t\t\tconst displayInfo =\n\t\t\t\t\t\t\tdisplayInfoOf === this.translateService.instant(\"CHAT.SUPPLIER\")\n\t\t\t\t\t\t\t\t? chatInfo.offer?.contact\n\t\t\t\t\t\t\t\t: chatInfo.buyer;\n\t\t\t\t\t\tconst author =\n\t\t\t\t\t\t\tdisplayInfo?.fullName ||\n\t\t\t\t\t\t\tdisplayInfo?.personName ||\n\t\t\t\t\t\t\t`${this.translateService.instant(\"CHAT.SUPPLIER\")} of ${chatInfo.offer?.title}`;\n\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t...chatInfo,\n\t\t\t\t\t\t\tdisplayInfo: {\n\t\t\t\t\t\t\t\t...displayInfo,\n\t\t\t\t\t\t\t\trole: displayInfoOf,\n\t\t\t\t\t\t\t\tauthor,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t};\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t})\n\t\t);\n\t}\n\n\tpublic getMessages() {\n\t\tconst user$ = this._authService.getUser();\n\t\tconst chat$ = this._activatedRoute.paramMap.pipe(\n\t\t\tmap((paramMap) => paramMap.get(\"id\")),\n\t\t\tswitchMap((id) => this._chatService.getChatById(id))\n\t\t);\n\n\t\treturn combineLatest([user$, chat$]).pipe(\n\t\t\tfilter(([user, chat]) => !!user && !!chat),\n\t\t\tswitchMap(([, chat]) =>\n\t\t\t\tthis._messagesHistory$.pipe(\n\t\t\t\t\ttap(() => {\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthis.chatContainer.nativeElement.scrollTop = this.chatContainer.nativeElement.scrollHeight;\n\t\t\t\t\t\t}, 0);\n\t\t\t\t\t}),\n\t\t\t\t\tmap((messages) =>\n\t\t\t\t\t\tmessages.map((message: { author: any; }) => {\n\t\t\t\t\t\t\tconst displayInfoOf =\n\t\t\t\t\t\t\t\tchat.seller?._id === message?.author\n\t\t\t\t\t\t\t\t\t? this.translateService.instant(\"CHAT.SUPPLIER\")\n\t\t\t\t\t\t\t\t\t: this.translateService.instant(\"CHAT.BUYER\");\n\t\t\t\t\t\t\tconst displayInfo =\n\t\t\t\t\t\t\t\tdisplayInfoOf === this.translateService.instant(\"CHAT.SUPPLIER\") ? chat.offer?.contact : chat.buyer;\n\t\t\t\t\t\t\tconst author = displayInfo?.fullName || displayInfo?.personName || chat.seller.fullName;\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t...message,\n\t\t\t\t\t\t\t\tcontact: {\n\t\t\t\t\t\t\t\t\t...displayInfo,\n\t\t\t\t\t\t\t\t\tauthor,\n\t\t\t\t\t\t\t\t\trole: displayInfo,\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t})\n\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t)\n\t\t);\n\t}\n\n\tpublic enterPressed(event: { preventDefault: () => void; }) {\n\t\tthis.sendMessage(this.formGroup.get(\"message\").value);\n\t\tevent.preventDefault();\n\t}\n\n\tpublic async sendMessage(body: any) {\n\t\tif (!body) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.chatInfo$.pipe(untilDestroyed(this)).subscribe((chatInfo) => {\n\t\t\tconst user = this._usersService.getUser();\n\t\t\tif (chatInfo.product) {\n\t\t\t\tconst productId = typeof chatInfo.product === \"string\" ? chatInfo.product : chatInfo.product._id;\n\t\t\t\tthis._socket.emit(\"message\", {\n\t\t\t\t\ttype: \"text\",\n\t\t\t\t\tbody,\n\t\t\t\t\tuserId: user._id === chatInfo.buyer?._id ? chatInfo.seller._id : chatInfo.buyer?._id,\n\t\t\t\t\tproductId,\n\t\t\t\t\ttypeRoom: \"product\",\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis._socket.emit(\"users_message\", {\n\t\t\t\t\ttype: \"text\",\n\t\t\t\t\tbody,\n\t\t\t\t\tuserId: user._id === chatInfo.buyer?._id ? chatInfo.seller._id : chatInfo.buyer?._id,\n\t\t\t\t\ttypeRoom: \"users\",\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis.formGroup.get(\"message\").reset();\n\t}\n\n\tpublic subscribeOnMessage() {\n\t\treturn this._socket.on(\"message\", (message: any) => {\n\t\t\tconst history = this._messagesHistoryBehaviourSubject.getValue();\n\t\t\tthis._messagesHistoryBehaviourSubject.next([...history, message]);\n\t\t});\n\t}\n\n\tpublic subscribeOnChatInfo() {\n\t\treturn this._socket.on(\"chat_info\", (chatInfo: { unreadMessagesCount: number; }) => {\n\t\t\tthis._socketService.readMessages(chatInfo.unreadMessagesCount);\n\t\t\tthis._chatInfoBehaviourSubject.next(chatInfo);\n\t\t});\n\t}\n\n\tpublic subscribeOnMessageHistory() {\n\t\treturn this._socket.on(\"message_history\", (message_history: any) => {\n\t\t\tthis._messagesHistoryBehaviourSubject.next(message_history);\n\t\t});\n\t}\n\n\tpublic subscribeOnUsersChatInfo() {\n\t\treturn this._socket.on(\"users_chat_info\", (chatInfo: { unreadMessagesCount: number; }) => {\n\t\t\tthis._socketService.readMessages(chatInfo.unreadMessagesCount);\n\t\t\tthis._chatInfoBehaviourSubject.next(chatInfo);\n\t\t});\n\t}\n\tpublic subscribeOnUsersChatMessage() {\n\t\treturn this._socket.on(\"users_message\", (message: any) => {\n\t\t\tconst history = this._messagesHistoryBehaviourSubject.getValue();\n\t\t\tthis._messagesHistoryBehaviourSubject.next([...history, message]);\n\t\t});\n\t}\n\n\tpublic subscribeOnUserChatMessageHistory() {\n\t\treturn this._socket.on(\"message_users_history\", (message_history: any) => {\n\t\t\tthis._messagesHistoryBehaviourSubject.next(message_history);\n\t\t});\n\t}\n\n\topenConnection(token: any) {\n\t\tif (this._socket) {\n\t\t\tthis._socket.disconnect();\n\t\t}\n\n\t\tthis._socket = io(environment.apiUrl, {\n\t\t\tpath: \"/chat\",\n\t\t\tauth: {\n\t\t\t\ttoken,\n\t\t\t},\n\t\t});\n\t}\n\n\tngOnInit() {\n\t\tconst token$ = this._usersService.getToken$();\n\t\tconst user$ = this._usersService.getUser$();\n\t\tconst chat$ = this._activatedRoute.paramMap.pipe(\n\t\t\tmap((paramMap) => paramMap.get(\"id\")),\n\t\t\tswitchMap((id) => this._chatService.getChatById(id))\n\t\t);\n\n\t\tcombineLatest([chat$, token$, user$])\n\t\t\t.pipe(untilDestroyed(this))\n\t\t\t.subscribe(([chat, token, user]: any) => {\n\t\t\t\tconst buyer = Array.isArray(chat.buyer) ? chat.buyer[0] : chat.buyer;\n\t\t\t\tconst seller = Array.isArray(chat.seller) ? chat.seller[0] : chat.seller;\n\n\t\t\t\tthis.openConnection(token);\n\n\t\t\t\tconst role = user._id === buyer?._id ? \"buyer\" : \"seller\";\n\t\t\t\tconst contactTo = role === \"seller\" ? buyer : seller;\n\n\t\t\t\tthis.displayContactsRequested = chat.contactsRequested && !this.displayContactsOpened;\n\t\t\t\tthis.displayRequestContacts =\n\t\t\t\t\trole === \"buyer\" &&\n\t\t\t\t\t!this.displayContactsOpened &&\n\t\t\t\t\t!this.displayContactsRequested &&\n\t\t\t\t\t(!chat.offer.visibility.email || !chat.offer.visibility.phone);\n\t\t\t\tthis.displayOpenContacts = role === \"seller\" && !this.displayContactsOpened && chat.contactsRequested;\n\t\t\t\tthis.displayCloseContacts = role === \"seller\" && !this.displayContactsOpened && chat.contactsRequested;\n\n\t\t\t\tthis.chat = chat;\n\n\t\t\t\tif (chat.typeRoom === \"product\") {\n\t\t\t\t\tthis.subscribeOnMessageHistory();\n\t\t\t\t\tthis.subscribeOnMessage();\n\t\t\t\t\tthis.subscribeOnChatInfo();\n\n\t\t\t\t\tthis._socket.emit(\"start_chat\", {\n\t\t\t\t\t\tuserId: contactTo?._id,\n\t\t\t\t\t\tproductId: chat.product,\n\t\t\t\t\t\ttypeRoom: \"product\",\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis._socket.emit(\"start_users_chat\", {\n\t\t\t\t\t\tuserId: contactTo?._id,\n\t\t\t\t\t\ttypeRoom: \"users\",\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.subscribeOnUsersChatInfo();\n\t\t\t\t\tthis.subscribeOnUserChatMessageHistory();\n\t\t\t\t\tthis.subscribeOnUsersChatMessage();\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tpublic getDestination(): string {\n\t\treturn this.rfqInfo?.rfq?.destination?.to ? getName(this.rfqInfo?.rfq?.destination?.to) : \"\";\n\t}\n\n\tpublic ngOnDestroy() {\n\t\tif (this._socket) {\n\t\t\tthis._socket.disconnect();\n\t\t}\n\t}\n}\n","<div class=\"client-profile-chat-wrapper\">\n\t<div class=\"rfq-info\">\n\t\t<div routerLink=\"/profile/your-workspace/b2bmarket\" class=\"client-profile-chat-buyer-info\">\n\t\t\t<div class=\"go-back\">\n\t\t\t\t<img b2bNgxIcon name=\"arrow-l\" alt=\"icon\">\n\t\t\t\t<div class=\"label\">Go back</div>\n\t\t\t</div>\n\t\t\t<ng-container *ngIf=\"chat?.typeRoom === 'product'\">\n\t\t\t\t<div class=\"product-name\">\n\t\t\t\t\tProduct: <span>{{ rfqInfo?.offerTitle }}</span>\n\t\t\t\t</div>\n\t\t\t\t<!--\t\t\t<div class=\"rfq-params\">-->\n\t\t\t\t<!--\t\t\t\t<span>Destination to: {{ getDestination() }}</span>-->\n\t\t\t\t<!--\t\t\t</div>-->\n\t\t\t</ng-container>\n\t\t</div>\n\t\t<div *ngIf=\"chatInfo$ | async as chatInfo\" class=\"client-profile-chat\">\n\t\t\t<form\n\t\t\t\t(keydown.enter)=\"enterPressed($event)\"\n\t\t\t\t[formGroup]=\"formGroup\"\n\t\t\t\t(ngSubmit)=\"sendMessage(formGroup.get('message').value)\"\n\t\t\t\tclass=\"client-profile-chat-container\">\n\t\t\t\t<p class=\"client-profile-chat-started\">{{ \"CHAT.CHAT_STARTED\" | translate }}\n\t\t\t\t\t: {{ chatInfo.createdAt | date }}</p>\n\n\t\t\t\t<div class=\"client-profile-chat-messages\">\n\t\t\t\t\t<ul class=\"client-profile-chat-messages-list\" #chatContainer>\n\t\t\t\t\t\t<li *ngFor=\"let message of messages$ | async\" class=\"client-profile-chat-messages-list-item\">\n\t\t\t\t\t\t\t<p class=\"client-profile-chat-messages-list-item-info\">\n\t\t\t\t\t\t\t\t<span class=\"client-profile-chat-messages-list-item-from\">{{ message.contact.author }}</span>\n\t\t\t\t\t\t\t\t<span class=\"client-profile-chat-messages-list-item-date\">{{ message.createdAt | date }}</span>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<p class=\"client-profile-chat-messages-list-item-message\">\n\t\t\t\t\t\t\t\t{{ message.body }}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li *ngIf=\"!(messages$ | async)?.length\" class=\"client-profile-chat-no-messages\">\n\t\t\t\t\t\t\t{{ \"CHAT.NO_MESSAGES\" | translate }}\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"message-wrapper\">\n\t\t\t\t<textarea\n\t\t\t\t\tformControlName=\"message\"\n\t\t\t\t\t[placeholder]=\"'PLACEHOLDERS.ENTER_TO_SEND' | translate\"\n\t\t\t\t\tclass=\"client-profile-chat-textarea\"\n\t\t\t\t\trows=\"5\"></textarea>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"client-profile-chat-actions\">\n\t\t\t\t\t<!--\t\t\t\t<div class=\"chat-actions-item-icons\">-->\n\t\t\t\t\t<!--\t\t\t\t\t<div class=\"icon-wrapper\">-->\n\t\t\t\t\t<!--\t\t\t\t\t\t<svg width=\"12\" height=\"16\" viewBox=\"0 0 12 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\t<path d=\"M10.3257 7.99998C11.3462 7.1743 12 5.9121 12 4.49997C12 2.01855 9.98142 0-->\n\t\t\t\t\t<!--\t\t\t\t\t\t7.49997 0H0V2.00001H0.999989V14H0V16H7.5C9.98145 16 12 13.9815 12 11.5C12 10.0879-->\n\t\t\t\t\t<!--\t\t\t\t\t\t11.3462 8.82566 10.3257 7.99998ZM7.49997 14H2.99997V9.00001H7.49997C8.8784 9.00001-->\n\t\t\t\t\t<!--\t\t\t\t\t\t9.99996 10.1216 9.99996 11.5C9.99996 12.8784 8.8784 14 7.49997 14ZM7.49997-->\n\t\t\t\t\t<!--\t\t\t\t\t\t6.99999H2.99997V2.00001H7.49997C8.8784 2.00001 9.99996 3.1216 9.99996-->\n\t\t\t\t\t<!--\t\t\t\t\t\t4.5C9.99996 5.87841 8.8784 6.99999 7.49997 6.99999Z\" fill=\"#9FA4BB\"/>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t</svg>-->\n\t\t\t\t\t<!--\t\t\t\t\t</div>-->\n\n\t\t\t\t\t<!--\t\t\t\t\t<div class=\"icon-wrapper\">-->\n\t\t\t\t\t<!--\t\t\t\t\t\t<svg width=\"12\" height=\"16\" viewBox=\"0 0 12 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\t<path d=\"M12 2.00001V0H5.99997V2.00001H7.48355L2.34073 14H0V16H6V14H4.51642L9.65921 2.00001H12Z\"-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\t\t\t\tfill=\"#9FA4BB\"/>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t</svg>-->\n\t\t\t\t\t<!--\t\t\t\t\t</div>-->\n\t\t\t\t\t<!--\t\t\t\t\t<svg width=\"32\" height=\"32\" viewBox=\"0 0 32 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">-->\n\t\t\t\t\t<!--\t\t\t\t\t\t<rect width=\"32\" height=\"32\" rx=\"4\" fill=\"white\"/>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t<g clip-path=\"url(#clip0_1026_5781)\">-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\t<path d=\"M11.585 15.1309H24.1564V17.4166H11.585V15.1309Z\" fill=\"#9FA4BB\"/>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\t<path d=\"M11.585 21.0405H24.1564V23.3263H11.585V21.0405Z\" fill=\"#9FA4BB\"/>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\t<path d=\"M11.585 9.22119H24.1564V11.5069H11.585V9.22119Z\" fill=\"#9FA4BB\"/>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\t<path d=\"M8.03906 9.22119H10.3248V11.5069H8.03906V9.22119Z\" fill=\"#9FA4BB\"/>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\t<path d=\"M8.03906 15.1309H10.3248V17.4166H8.03906V15.1309Z\" fill=\"#9FA4BB\"/>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\t<path d=\"M8.03906 21.0405H10.3248V23.3263H8.03906V21.0405Z\" fill=\"#9FA4BB\"/>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t</g>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t<defs>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\t<clipPath id=\"clip0_1026_5781\">-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\t\t<rect width=\"16\" height=\"16\" fill=\"white\" transform=\"translate(8 8)\"/>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\t</clipPath>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t</defs>-->\n\t\t\t\t\t<!--\t\t\t\t\t</svg>-->\n\n\t\t\t\t\t<!--\t\t\t\t\t<svg width=\"32\" height=\"32\" viewBox=\"0 0 32 32\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">-->\n\t\t\t\t\t<!--\t\t\t\t\t\t<rect width=\"32\" height=\"32\" rx=\"4\" fill=\"white\"/>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t<path-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\td=\"M16 8C11.5817 8 8 11.5817 8 16C8 20.4183 11.5817 24 16 24C20.4183 24 24 20.4183 24 16C23.9953 11.5837 20.4163 8.00472 16 8ZM16 22.8571C12.2129 22.8571 9.14285 19.7871 9.14285 16C9.14285 12.2129 12.2129 9.14285 16 9.14285C19.7871 9.14285 22.8571 12.2129 22.8571 16C22.853 19.7854 19.7854 22.853 16 22.8571Z\"-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\tfill=\"#9FA4BB\" stroke=\"#9FA4BB\" stroke-width=\"0.6\"/>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t<path-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\td=\"M13.1428 16C13.774 16 14.2857 15.4884 14.2857 14.8572C14.2857 14.226 13.774 13.7144 13.1428 13.7144C12.5117 13.7144 12 14.226 12 14.8572C12 15.4884 12.5117 16 13.1428 16Z\"-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\tfill=\"#9FA4BB\" stroke=\"#9FA4BB\" stroke-width=\"0.6\"/>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t<path-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\td=\"M18.8572 16C19.4884 16 20 15.4884 20 14.8572C20 14.226 19.4884 13.7144 18.8572 13.7144C18.226 13.7144 17.7144 14.226 17.7144 14.8572C17.7144 15.4884 18.226 16 18.8572 16Z\"-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\tfill=\"#9FA4BB\" stroke=\"#9FA4BB\" stroke-width=\"0.6\"/>-->\n\t\t\t\t\t<!--\t\t\t\t\t\t<path-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\td=\"M18.1881 17.9314C17.9994 17.6784 17.6413 17.6264 17.3884 17.8152C17.3775 17.8233 17.3669 17.8319 17.3565 17.8408C16.5484 18.431 15.4514 18.431 14.6433 17.8408C14.4046 17.6344 14.0437 17.6607 13.8374 17.8995C13.631 18.1382 13.6573 18.4991 13.896 18.7055C13.9063 18.7144 13.917 18.7229 13.9279 18.7311C15.1511 19.666 16.8488 19.666 18.0719 18.7311C18.3249 18.5423 18.3769 18.1843 18.1881 17.9314Z\"-->\n\t\t\t\t\t<!--\t\t\t\t\t\t\tfill=\"#9FA4BB\" stroke=\"#9FA4BB\" stroke-width=\"0.6\"/>-->\n\t\t\t\t\t<!--\t\t\t\t\t</svg>-->\n\t\t\t\t\t<!--\t\t\t\t</div>-->\n\t\t\t\t\t<div class=\"chat-actions-item-buttons\">\n\t\t\t\t\t\t<!--\t\t\t\t\t<div class=\"chat-actions-item-block\">-->\n\t\t\t\t\t\t<!--\t\t\t\t\t\t<b2b-ngx-file-->\n\t\t\t\t\t\t<!--\t\t\t\t\t\t\t[isPhoto]=\"false\"-->\n\t\t\t\t\t\t<!--\t\t\t\t\t\t\tlabel=\"\"-->\n\t\t\t\t\t\t<!--\t\t\t\t\t\t></b2b-ngx-file>-->\n\t\t\t\t\t\t<!--\t\t\t\t\t</div>-->\n\t\t\t\t\t\t<div class=\"chat-actions-item-block\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tb2bNgxButton\n\t\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\t\t[theme]=\"b2bNgxButtonThemeEnum.BACKGROUND_BLACK\"\n\t\t\t\t\t\t\t\tclass=\"client-profile-chat-actions-send-button\">\n\t\t\t\t\t\t\t\t<span>{{ \"BUTTONS.SEND\" | translate }}</span>\n\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\tclass=\"client-profile-chat-actions-send-button-icon\"\n\t\t\t\t\t\t\t\t\twidth=\"16\"\n\t\t\t\t\t\t\t\t\theight=\"16\"\n\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\td=\"M15.832 7.26899C15.6676 6.92953 15.3935 6.65544 15.0541 6.49106L2.407 0.371217C1.57387\n\t\t\t\t\t\t -0.0324159 0.571319 0.315791 0.167686 1.14892C-0.0379446 1.57341 -0.0552305 2.06491 0.120117\n\t\t\t\t\t\t  2.50279L2.31929 7.99965L0.120117 13.4971C-0.222426 14.3594 0.198984 15.3362 1.06135 15.6787C1.25634\n\t\t\t\t\t\t  15.7562 1.46413 15.7964 1.67395 15.7974C1.92781 15.7974 2.17839 15.7401 2.407 15.6298L15.054\n\t\t\t\t\t\t  9.50824C15.8872 9.10471 16.2355 8.10216 15.832 7.26899ZM1.92034 14.6224C1.64259 14.7568 1.30843 14.6407\n\t\t\t\t\t\t  1.17397 14.3629C1.10545 14.2214 1.09975 14.0576 1.15822 13.9116L3.29929 8.55837H14.4523L1.92034 14.6224ZM3.29932\n\t\t\t\t\t\t  7.4409L1.15826 2.08763C1.06914 1.87424 1.12447 1.62782 1.29625 1.47303C1.46253 1.31101 1.7136 1.273 1.92034\n\t\t\t\t\t\t  1.37861L14.4523 7.4409H3.29932Z\"\n\t\t\t\t\t\t\t\t\t\tfill=\"#9FA4BB\"/>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</form>\n\n\t\t\t<div class=\"client-profile-chat-buyer-info\">\n\t\t\t\t<div class=\"buyer-info-profile\">\n\t\t\t\t\t<div class=\"buyer-info-title\">{{ chatInfo.displayInfo.role }} info</div>\n\t\t\t\t\t<div class=\"buyer-info-header\">\n\t\t\t\t\t\t<div class=\"buyer-info-header-name\">{{ buyerContacts?.fullName }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<!--\t\t\t<div class=\"buyer-info-country\">from </div>-->\n\t\t\t\t\t<div class=\"buyer-info-block\">\n\t\t\t\t\t\t<div class=\"subtitle\">Email</div>\n\t\t\t\t\t\t<div class=\"subtext\">{{ buyerContacts?.email }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"buyer-info-block\">\n\t\t\t\t\t\t<div class=\"subtitle\">Phone</div>\n\t\t\t\t\t\t<div class=\"subtext\">{{ buyerContacts?.phone.e164Number }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<!--\t\t\t\t<div class=\"buyer-info-block\">-->\n\t\t\t\t\t<!--\t\t\t\t\t<div class=\"subtitle\">Web</div>-->\n\t\t\t\t\t<!--\t\t\t\t\t<div class=\"subtext\">{{ buyerContacts?.site }}</div>-->\n\t\t\t\t\t<!--\t\t\t\t</div>-->\n\t\t\t\t</div>\n\t\t\t\t<div class=\"buyer-info-product\">\n\t\t\t\t\t<div class=\"buyer-info-product-title\">Media</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"buyer-info-warning\">\n\t\t\t\t\t<svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t<path\n\t\t\t\t\t\t\td=\"M7.119 1.77272C7.49724 1.07443 8.49934 1.07443 8.87758 1.77272L14.9665 13.0137C15.3274 13.68 14.8449 14.49 14.0872 14.49H1.90941C1.15164 14.49 0.669209 13.68 1.03012 13.0137L7.119 1.77272Z\"\n\t\t\t\t\t\t\tstroke=\"#9FA4BB\"\n\t\t\t\t\t\t\tstroke-width=\"1.6\"\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"/>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<div class=\"buyer-info-warning-link\">\n\t\t\t\t\t\t<a href=\"\">Report this buyer</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n\n<ng-template #userDeleted>\n\t<p class=\"user-deleted\">\n\t\t{{ \"CHAT.USER_DELETED\" | translate }}\n\t</p>\n</ng-template>\n","import { Injectable } from \"@angular/core\";\nimport { map } from \"rxjs/operators\";\nimport { ApiService } from \"../../../core/services/api/api.service\";\n\n@Injectable({\n\tprovidedIn: \"root\",\n})\nexport class ChatService {\n\tconstructor(private readonly _apiService: ApiService) {}\n\n\tpublic getChatById(id: string) {\n\t\treturn this._apiService.get(`my/chat/${id}`).pipe(\n\t\t\tmap((chat: any) => (Array.isArray(chat) ? chat[0] : chat)),\n\t\t\tmap((chat) => ({\n\t\t\t\t...chat,\n\t\t\t\toffer: Array.isArray(chat.offer) ? chat.offer[0] : chat.offer,\n\t\t\t}))\n\t\t);\n\t}\n}\n"],"names":["ChangeDetectorRef","ElementRef","B2bNgxButtonThemeEnum","UntilDestroy","untilDestroyed","BehaviorSubject","combineLatest","filter","map","switchMap","tap","io","environment","getName","i0","ctx_r11","value","ClientChatComponent","constructor","_activatedRoute","_chatService","_chatsService","_usersService","_formBuilder","_authService","_socketService","_hotToastService","changeDetectorRef","b2bNgxLinkService","translateService","mixpanelService","b2bNgxButtonThemeEnum","formGroup","group","message","_messagesHistoryBehaviourSubject","_messagesHistory$","asObservable","_messageBehaviourSubject","_message$","_chatInfoBehaviourSubject","_chatInfo$","chatInfo$","getChatInfo","messages$","getMessages","getUser","pipe","user","chatInfo","buyer","_id","buyerContacts","seller","rfqInfo","buyerStatus","isActive","displayInfoOf","_a","instant","displayInfo","offer","_b","contact","author","fullName","personName","_c","title","role","user$","chat$","paramMap","get","id","getChatById","chat","setTimeout","chatContainer","nativeElement","scrollTop","scrollHeight","messages","enterPressed","event","sendMessage","preventDefault","body","subscribe","product","productId","_socket","emit","type","userId","typeRoom","_d","reset","subscribeOnMessage","on","history","getValue","next","subscribeOnChatInfo","readMessages","unreadMessagesCount","subscribeOnMessageHistory","message_history","subscribeOnUsersChatInfo","subscribeOnUsersChatMessage","subscribeOnUserChatMessageHistory","openConnection","token","disconnect","apiUrl","path","auth","ngOnInit","token$","getToken$","getUser$","Array","isArray","contactTo","displayContactsRequested","contactsRequested","displayContactsOpened","displayRequestContacts","visibility","email","phone","displayOpenContacts","displayCloseContacts","getDestination","rfq","destination","to","_e","_f","ngOnDestroy","selectors","viewQuery"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}